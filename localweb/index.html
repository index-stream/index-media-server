<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index Media Server</title>
    <link rel="stylesheet" href="./styles/main.css">
    <meta name="theme-color" content="#0f172a">
    <meta name="description" content="Local media server">
    <script type="module" src="./scripts/main.js"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen">
    <!-- Main App Container -->
    <div id="app" class="min-h-screen">
        <!-- Initial Page -->
        <div id="initial-page" class="flex flex-col items-center justify-center min-h-screen p-8">
            <div class="max-w-4xl mx-auto text-center">
                <!-- Loading Content -->
            </div>
        </div>
        <!-- Setup Page -->
        <div id="setup-page" class="hidden flex flex-col items-center justify-center min-h-screen p-8">
            <div class="w-full max-w-4xl mx-auto text-center">
                <!-- Initial Setup Content -->
                <div id="setup-initial-content">
                    <h1 class="text-6xl font-bold mb-6 bg-gradient-to-r from-blue-500 to-green-500 bg-clip-text text-transparent">
                        Index Media Server
                    </h1>
                    <p class="text-xl text-gray-300 mb-8 leading-relaxed">
                        Ready to setup your media server and start streaming video content?
                    </p>
                    <button id="setup-btn" class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-4 px-8 rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                        Let's Get Started
                    </button>
                </div>

                <!-- Step 1: Profile Creation (Hidden Initially) -->
                <div id="setup-step-1" class="hidden w-full max-w-md mx-auto">
                    <h2 class="text-3xl font-bold mb-6 text-white">Create Your Profiles</h2>
                    <p class="text-lg text-gray-300 mb-8">Set up profiles to personalize your media experience.</p>
                    
                    <!-- Profiles List -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-300 mb-3">Your Profiles</label>
                        <div id="profiles-list" class="space-y-3 mb-4 min-h-[120px] border border-gray-500 rounded-lg p-4 bg-gray-700">
                            <p class="text-gray-500 text-sm text-center py-8">No profiles added yet</p>
                        </div>
                        
                        <!-- Add Profile Button -->
                        <button type="button" id="add-profile-btn" class="w-full bg-gray-600 hover:bg-gray-500 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 border-2 border-dashed border-gray-400 hover:border-gray-300">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                            Add Profile
                        </button>
                    </div>


                    <!-- Continue Button -->
                    <div class="pt-6">
                        <button type="button" id="continue-to-index-name-btn" class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl" disabled>
                            Continue
                        </button>
                        <p id="profiles-error" class="text-red-400 text-sm mt-2 text-center hidden">Please add at least one profile to continue.</p>
                    </div>
                </div>

                <!-- Step 2: Password Setup (Hidden Initially) -->
                <div id="setup-step-2" class="hidden w-full max-w-md mx-auto">
                    <h2 class="text-3xl font-bold mb-6 text-white">Secure Your Server</h2>
                    <p class="text-lg text-gray-300 mb-8">We recommend setting up a password to protect your media server from unauthorized access.</p>
                    
                    <form id="password-form" class="space-y-6">
                        <div class="text-left">
                            <label for="server-password" class="block text-sm font-medium text-gray-300 mb-2">Server Password (Optional)</label>
                            <input type="password" id="server-password" name="server-password" placeholder="Enter a secure password" 
                                   class="w-full px-4 py-3 bg-gray-700 border border-gray-500 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <p class="text-gray-400 text-sm mt-2">Leave blank to allow unrestricted access</p>
                        </div>

                        <div class="text-left">
                            <label for="confirm-password" class="block text-sm font-medium text-gray-300 mb-2">Confirm Password</label>
                            <input type="password" id="confirm-password" name="confirm-password" placeholder="Confirm your password" 
                                   class="w-full px-4 py-3 bg-gray-700 border border-gray-500 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>

                        <!-- Password Error Message -->
                        <div id="password-error" class="text-red-400 text-sm text-center hidden">Passwords do not match. Please try again.</div>

                        <div class="flex space-x-4 pt-4">
                            <button type="button" id="back-to-profiles-btn" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200">
                                Back
                            </button>
                            <button type="submit" id="continue-to-index-name-btn" class="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                                Continue
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Step 3: Index Name (Hidden Initially) -->
                <div id="setup-step-3" class="hidden w-full max-w-md mx-auto">
                    <h2 class="text-3xl font-bold mb-6 text-white">Create a Local Media Index</h2>
                    
                    <form id="name-form" class="space-y-6">
                        <div class="text-left">
                            <label for="index-name" class="block text-sm font-medium text-gray-300 mb-2">Index Name</label>
                            <input type="text" id="index-name" name="index-name" value="Home" 
                                   class="w-full px-4 py-3 bg-gray-700 border border-gray-500 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>

                        <div class="text-left">
                            <label class="block text-sm font-medium text-gray-300 mb-3">Media Type</label>
                            <div class="grid grid-cols-3 gap-4 mb-4">
                                <!-- Videos -->
                                <div class="media-type-option" data-type="videos">
                                    <img src="./images/icon_movie.png" alt="Videos" class="w-16 h-16 mx-auto rounded-lg border-2 border-transparent hover:border-blue-500 cursor-pointer">
                                    <p class="text-sm text-gray-300 mt-2 text-center">Videos</p>
                                </div>
                                <!-- Photos -->
                                <div class="media-type-option" data-type="photos">
                                    <img src="./images/icon_image.png" alt="Photos" class="w-16 h-16 mx-auto rounded-lg border-2 border-transparent hover:border-blue-500 cursor-pointer">
                                    <p class="text-sm text-gray-300 mt-2 text-center">Photos</p>
                                </div>
                                <!-- Music -->
                                <div class="media-type-option" data-type="music">
                                    <img src="./images/icon_music.png" alt="Music" class="w-16 h-16 mx-auto rounded-lg border-2 border-transparent hover:border-blue-500 cursor-pointer">
                                    <p class="text-sm text-gray-300 mt-2 text-center">Music</p>
                                </div>
                            </div>
                        </div>

                        <div class="flex space-x-4 pt-4">
                            <button type="button" id="back-to-password-btn" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200">
                                Back
                            </button>
                            <button type="button" id="skip-btn" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200">
                                Skip
                            </button>
                            <button type="submit" id="continue-to-icon-btn" class="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                                Continue
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Step 4: Icon Selection (Hidden Initially) -->
                <div id="setup-step-4" class="hidden w-full max-w-md mx-auto">
                    <h2 class="text-3xl font-bold mb-6 text-white">Choose an Icon</h2>
                    <p class="text-lg text-gray-300 mb-8">Select an icon for your "<span id="index-name-display">Home</span>" index.</p>
                    
                    <form id="icon-form" class="space-y-6">
                        <div class="text-left">
                            <label class="block text-sm font-medium text-gray-300 mb-3">Choose Icon</label>
                            <div class="grid grid-cols-5 gap-4 mb-4">
                                <!-- Default Icons -->
                                <div class="icon-option" data-icon="home">
                                    <img src="./images/icon_home.png" alt="Home Icon" class="w-16 h-16 mx-auto rounded-lg border-2 border-transparent hover:border-blue-500 cursor-pointer">
                                </div>
                                <div class="icon-option" data-icon="movie">
                                    <img src="./images/icon_movie.png" alt="Movie Icon" class="w-16 h-16 mx-auto rounded-lg border-2 border-transparent hover:border-blue-500 cursor-pointer">
                                </div>
                                <div class="icon-option" data-icon="image">
                                    <img src="./images/icon_image.png" alt="Image Icon" class="w-16 h-16 mx-auto rounded-lg border-2 border-transparent hover:border-blue-500 cursor-pointer">
                                </div>
                                <div class="icon-option" data-icon="music">
                                    <img src="./images/icon_music.png" alt="Music Icon" class="w-16 h-16 mx-auto rounded-lg border-2 border-transparent hover:border-blue-500 cursor-pointer">
                                </div>
                                
                                <!-- Custom Upload Option -->
                                <div class="icon-option" data-icon="custom">
                                    <div class="w-16 h-16 mx-auto rounded-lg border-2 border-dashed border-gray-400 hover:border-blue-500 cursor-pointer flex items-center justify-center bg-gray-700 hover:bg-gray-600 transition-colors">
                                        <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                        </svg>
                                    </div>
                                    <p class="text-xs text-gray-400 mt-2 text-center">Upload</p>
                                </div>
                            </div>
                            
                            <!-- Hidden file input -->
                            <input type="file" id="custom-icon" name="custom-icon" accept="image/*" class="hidden">
                        </div>

                        <div class="flex space-x-4 pt-4">
                            <button type="button" id="back-to-name-btn" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200">
                                Back
                            </button>
                            <button type="submit" id="continue-to-folders-btn" class="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                                Continue
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Step 5: Folder Selection (Hidden Initially) -->
                <div id="setup-step-5" class="hidden w-fit max-w-2xl mx-auto">
                    <h2 class="text-3xl font-bold mb-6 text-white">Select Folders</h2>
                    <p class="text-lg text-gray-300 mb-8">Choose which folders your "<span id="index-name-display-step5">Home</span>" index can read from.</p>
                    
                    <form id="folders-form" class="space-y-6">
                        <div class="text-left">
                            <label class="block text-sm font-medium text-gray-300 mb-3">Selected Folders</label>
                            
                            <!-- Selected Folders List -->
                            <div id="selected-folders-list" class="space-y-2 mb-4 min-h-[100px] border border-gray-500 rounded-lg p-4 bg-gray-700">
                                <p class="text-gray-500 text-sm text-center py-8">No folders selected yet</p>
                            </div>
                            
                            <!-- Add Folders Button -->
                            <button type="button" id="add-folders-btn" class="w-full bg-gray-600 hover:bg-gray-500 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 border-2 border-dashed border-gray-400 hover:border-gray-300">
                                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                                Add Folders
                            </button>
                        </div>

                        <div class="flex space-x-4 pt-4">
                            <button type="button" id="back-to-icon-btn" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200">
                                Back
                            </button>
                            <button type="submit" id="finish-setup-btn" class="flex-1 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                                Finish Setup
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!-- Home Page -->
        <div id="home-page" class="hidden flex flex-col items-center justify-center min-h-screen p-8">
            <div class="max-w-4xl mx-auto text-center">
                <h1 class="text-6xl font-bold mb-6 bg-gradient-to-r from-blue-500 to-green-500 bg-clip-text text-transparent">
                    Index Media Server
                </h1>
                <p class="text-xl text-gray-300 mb-8 leading-relaxed">
                    Your media server is running! Use the connect code below to stream content from other devices on the same network.
                </p>

                <!-- Connect Code Section -->
                <div class="bg-gray-700 border border-gray-500 rounded-lg p-6 mb-8">
                    <h2 class="text-2xl font-semibold text-white mb-4">Connect Code</h2>
                    <div class="bg-gray-800 border border-gray-600 rounded-lg p-4 mb-4">
                        <code id="connect-code" class="text-3xl font-mono text-green-400"></code>
                    </div>
                    <p class="text-gray-400 text-sm mb-4">Share this code with devices on the same WiFi network to access your media server</p>
                    
                    <!-- Streaming Link -->
                    <div class="text-center">
                        <button id="start-streaming-link" class="text-blue-400 hover:text-blue-300 underline transition-colors text-sm">
                            Start streaming from this device
                        </button>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <!-- Manage Indexes Button -->
                    <button id="manage-indexes-btn" class="bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white font-semibold py-4 px-6 rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                        <svg class="w-6 h-6 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                        </svg>
                        Manage Indexes
                    </button>

                    <!-- Manage Profiles Button -->
                    <button id="manage-profiles-btn" class="bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white font-semibold py-4 px-6 rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                        <svg class="w-6 h-6 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        Manage Profiles
                    </button>

                    <!-- Manage Password Button -->
                    <button id="manage-password-btn" class="bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white font-semibold py-4 px-6 rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                        <svg class="w-6 h-6 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                        Manage Password
                    </button>
                </div>

                <!-- Status Information -->
                <div class="bg-gray-700 border border-gray-500 rounded-lg p-4">
                    <div class="flex items-center justify-center">
                        <div class="w-3 h-3 bg-green-400 rounded-full mr-3"></div>
                        <span class="text-gray-300">Server is running and ready to accept connections</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
